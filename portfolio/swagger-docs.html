<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Module 5 Lab - API Documentation</title>
        <link rel="stylesheet" href="css/main.css" />
        <link
            rel="stylesheet"
            href="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui.css"
        />
        <style>
            .swagger-container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }

            .header {
                text-align: center;
                padding: 60px 20px;
                color: white;
                margin-bottom: 30px;
            }

            .header h1 {
                font-size: 2.5em;
                margin-bottom: 10px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }

            .header p {
                font-size: 1.2em;
                opacity: 0.9;
            }

            .header-logo {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                vertical-align: middle;
                margin-right: 15px;
            }

            .exercise-selector {
                background: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                margin-bottom: 30px;
            }

            .exercise-tabs {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(2, 1fr);
                gap: 15px;
                margin-bottom: 20px;
                justify-content: center;
                max-width: 800px;
                margin: 0 auto 20px auto;
            }

            .exercise-tab {
                padding: 15px 10px;
                background: #f8f9fa;
                border: 2px solid #e9ecef;
                border-radius: 8px;
                cursor: pointer;
                transition: all 0.3s ease;
                font-weight: 500;
                text-align: center;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                min-height: 80px;
                gap: 5px;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .exercise-tab:hover {
                background: #e9ecef;
                border-color: #dee2e6;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            }

            .exercise-tab.active {
                background: #667eea;
                color: white;
                border-color: #667eea;
                transform: translateY(-1px);
                box-shadow: 0 3px 6px rgba(102, 126, 234, 0.3);
            }

            .exercise-info {
                background: #f8f9fa;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
                text-align: center;
                max-width: 800px;
                margin: 0 auto 20px auto;
            }

            .exercise-info h3 {
                margin: 0 0 10px 0;
                color: #495057;
            }

            .exercise-info p {
                margin: 0;
                color: #6c757d;
                line-height: 1.5;
            }

            .swagger-ui-container {
                background: white;
                border-radius: 10px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                overflow: hidden;
            }

            .loading {
                text-align: center;
                padding: 50px;
                color: #6c757d;
            }

            .error {
                background: #f8d7da;
                color: #721c24;
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
            }

            .home-nav {
                text-align: center;
                margin-bottom: 20px;
            }

            .home-nav .btn {
                display: inline-block;
                background: #667eea;
                color: white;
                padding: 12px 24px;
                text-decoration: none;
                border-radius: 25px;
                transition: all 0.3s ease;
                font-weight: 500;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .home-nav .btn:hover {
                background: #5a6fd8;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            }

            .footer {
                text-align: center;
                padding: 40px 20px;
                color: white;
                margin-top: 60px;
            }

            .footer p {
                margin: 5px 0;
                opacity: 0.9;
            }

            .github-link {
                display: inline-block;
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 15px 30px;
                border-radius: 50px;
                text-decoration: none;
                margin-top: 20px;
                transition: all 0.3s ease;
                font-weight: 600;
                font-size: 1.1em;
            }

            .github-link:hover {
                background: rgba(0, 0, 0, 0.9);
                transform: translateY(-2px);
            }

            /* Swagger UI customizations */
            .swagger-ui .topbar {
                display: none;
            }

            .swagger-ui .info {
                margin: 20px 0;
            }

            .swagger-ui .scheme-container {
                background: #f8f9fa;
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
            }

            /* Mock server notice */
            .mock-notice {
                background: #d4edda;
                color: #155724;
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
                border: 1px solid #c3e6cb;
            }

            .mock-notice h4 {
                margin: 0 0 10px 0;
                color: #155724;
            }

            .mock-notice p {
                margin: 5px 0;
            }

            @media (max-width: 768px) {
                .exercise-tabs {
                    grid-template-columns: repeat(2, 1fr);
                    grid-template-rows: repeat(4, 1fr);
                    gap: 10px;
                    max-width: 400px;
                }

                .exercise-tab {
                    padding: 12px 8px;
                    min-height: 70px;
                    font-size: 0.9em;
                }

                .swagger-header h1 {
                    font-size: 2em;
                }
            }

            @media (max-width: 480px) {
                .exercise-tabs {
                    grid-template-columns: repeat(1, 1fr);
                    grid-template-rows: repeat(8, 1fr);
                    max-width: 300px;
                }

                .exercise-tab {
                    padding: 10px 8px;
                    min-height: 60px;
                }
            }
        </style>
    </head>
    <body>
        <div class="swagger-container">
            <header class="header">
                <h1>
                    <img
                        src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRG3HuBlAUw3Wu-46hoogyANMHo1VC-tKnE1Q&s"
                        alt="IOD Logo"
                        class="header-logo"
                    />Module 5 Lab - API Documentation
                </h1>
                <p>Comprehensive Swagger documentation for all exercises</p>
            </header>

            <div class="home-nav">
                <a href="index.html" class="btn">üè† Home</a>
            </div>

            <div class="exercise-selector">
                <h3
                    style="
                        text-align: center;
                        margin-bottom: 25px;
                        color: #495057;
                        font-size: 1.3em;
                    "
                >
                    Select Exercise to View Documentation
                </h3>
                <div class="exercise-tabs">
                    <div class="exercise-tab active" data-exercise="1">
                        <div><strong>Exercise 1</strong></div>
                        <div><small>Multi-Port Servers</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="2">
                        <div><strong>Exercise 2</strong></div>
                        <div><small>Basic Calculator</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="3">
                        <div><strong>Exercise 3</strong></div>
                        <div><small>Calculator + Portfolio</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="4">
                        <div><strong>Exercise 4</strong></div>
                        <div><small>Friends API</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="5">
                        <div><strong>Exercise 5</strong></div>
                        <div><small>Friends MVC</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="6">
                        <div><strong>Exercise 6</strong></div>
                        <div><small>Calculator + Tests</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="7">
                        <div><strong>Exercise 7</strong></div>
                        <div><small>Enhanced Calculator</small></div>
                    </div>
                    <div class="exercise-tab" data-exercise="8">
                        <div><strong>Exercise 8</strong></div>
                        <div><small>eCommerce Store</small></div>
                    </div>
                </div>

                <div class="exercise-info">
                    <h3 id="exercise-title">
                        Exercise 1 - Multi-Port Server Management
                    </h3>
                    <p id="exercise-description">
                        Learn how to create and manage multiple Express.js
                        servers running on different ports simultaneously.
                    </p>
                </div>
            </div>

            <div class="swagger-ui-container">
                <div id="swagger-ui"></div>
                <div id="loading" class="loading">
                    Loading API documentation...
                </div>
                <div id="error" class="error" style="display: none">
                    Failed to load API documentation. Please try again.
                </div>
            </div>

            <div class="mock-notice">
                <h4>üé≠ Simulation Mode Active</h4>
                <p>
                    <strong
                        >This documentation is running in full simulation mode
                        with realistic mock data.</strong
                    >
                </p>
                <p>
                    ‚úÖ <strong>How it works:</strong> Click "Try it out" and
                    "Execute" to see realistic mock responses that demonstrate
                    what the actual APIs would return when called.
                </p>
                <p>
                    üìä <strong>What you'll see:</strong> Realistic JSON
                    responses that match what the actual APIs would return,
                    including proper data structures, timestamps, and operation
                    results.
                </p>
                <p>
                    üöÄ <strong>Perfect for:</strong> API testing, response
                    format verification, and understanding endpoint behavior
                    without needing running servers.
                </p>
            </div>

            <div class="footer">
                <p>Samuel Love 2025</p>
                <p>Web Development Portfolio</p>
                <a
                    href="https://github.com/tatoslover/Module5Lab"
                    class="github-link"
                    target="_blank"
                >
                    View on GitHub
                </a>
            </div>
        </div>

        <script src="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui-bundle.js"></script>
        <script src="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui-standalone-preset.js"></script>
        <script src="js/swagger-specs.js"></script>
        <script>
            const exercises = {
                1: {
                    title: "Exercise 1 - Multi-Port Server Management",
                    description:
                        "Learn how to create and manage multiple Express.js servers running on different ports simultaneously.",
                    file: "swagger/exercise1.yaml",
                },
                2: {
                    title: "Exercise 2 - Basic Calculator API",
                    description:
                        "Simple REST API for basic arithmetic operations with query parameters.",
                    file: "swagger/exercise2.yaml",
                },
                3: {
                    title: "Exercise 3 - Calculator with Portfolio Integration",
                    description:
                        "Enhanced calculator API with integrated portfolio showcase and static file serving.",
                    file: "swagger/exercise3.yaml",
                },
                4: {
                    title: "Exercise 4 - Friends Management API",
                    description:
                        "Complete CRUD API for managing friends data with filtering, searching, and validation.",
                    file: "swagger/exercise4.yaml",
                },
                5: {
                    title: "Exercise 5 - Friends API with MVC Architecture",
                    description:
                        "Professional MVC implementation of the Friends API with clean separation of concerns.",
                    file: "swagger/exercise5.yaml",
                },
                6: {
                    title: "Exercise 6 - Calculator API with Comprehensive Testing",
                    description:
                        "Calculator API with Jest testing framework and comprehensive test coverage.",
                    file: "swagger/exercise6.yaml",
                },
                7: {
                    title: "Exercise 7 - Enhanced Calculator with Advanced Libraries",
                    description:
                        "Professional calculator API with advanced logging, error handling, and custom libraries.",
                    file: "swagger/exercise7.yaml",
                },
                8: {
                    title: "Exercise 8 - eCommerce Store API",
                    description:
                        "Full-featured eCommerce API with product management, search, caching, and comprehensive documentation.",
                    file: "swagger/exercise8.yaml",
                },
            };

            let currentSwaggerUI = null;
            let currentExercise = 1;
            let isLoading = false;
            let loadingQueue = [];
            let debounceTimer = null;

            function updateExerciseInfo(exerciseNumber) {
                const exercise = exercises[exerciseNumber];
                document.getElementById("exercise-title").textContent =
                    exercise.title;
                document.getElementById("exercise-description").textContent =
                    exercise.description;
            }

            function showLoading() {
                document.getElementById("loading").style.display = "block";
                document.getElementById("error").style.display = "none";

                // Safely clear swagger-ui
                const container = document.getElementById("swagger-ui");
                if (container) {
                    container.innerHTML = "";
                }
            }

            function hideLoading() {
                document.getElementById("loading").style.display = "none";
            }

            function showError() {
                document.getElementById("loading").style.display = "none";
                document.getElementById("error").style.display = "block";

                // Safely clear swagger-ui
                const container = document.getElementById("swagger-ui");
                if (container) {
                    container.innerHTML = "";
                }

                // Reset state
                currentSwaggerUI = null;
                isLoading = false;
                processQueue();
            }

            function processQueue() {
                if (isLoading || loadingQueue.length === 0) return;

                const exerciseNumber = loadingQueue.shift();
                console.log(
                    `üìã Processing queue: Exercise ${exerciseNumber}, Queue length: ${loadingQueue.length}`,
                );
                createSwaggerUI(exerciseNumber);
            }

            function createSwaggerUI(exerciseNumber) {
                if (isLoading) return;

                // Safety check for required libraries
                if (
                    !window.SwaggerUIBundle ||
                    !window.SwaggerUIStandalonePreset
                ) {
                    console.error("SwaggerUI libraries not available");
                    showError();
                    return;
                }

                isLoading = true;
                console.log(
                    `üîÑ Creating Swagger UI for Exercise ${exerciseNumber}`,
                );

                const spec = window.swaggerSpecs[exerciseNumber];
                if (!spec) {
                    console.error(
                        `No specification found for exercise ${exerciseNumber}`,
                    );
                    showError();
                    return;
                }

                // Properly dispose of previous SwaggerUI instance
                if (
                    currentSwaggerUI &&
                    typeof currentSwaggerUI.getSystem === "function"
                ) {
                    try {
                        console.log("üßπ Disposing previous SwaggerUI instance");
                        currentSwaggerUI = null;
                    } catch (e) {
                        console.warn("Warning disposing SwaggerUI:", e);
                    }
                }

                // Clear the container and recreate it
                const container = document.getElementById("swagger-ui");
                const parent = container.parentNode;
                const newContainer = document.createElement("div");
                newContainer.id = "swagger-ui";
                parent.replaceChild(newContainer, container);

                // Longer delay to ensure proper cleanup
                setTimeout(() => {
                    try {
                        // Check if container still exists
                        const targetContainer =
                            document.getElementById("swagger-ui");
                        if (!targetContainer) {
                            console.error("Target container not found");
                            showError();
                            return;
                        }

                        // Remove server URLs from spec to prevent network requests
                        const cleanSpec = JSON.parse(JSON.stringify(spec));
                        if (cleanSpec.servers) {
                            delete cleanSpec.servers;
                        }

                        currentSwaggerUI = SwaggerUIBundle({
                            spec: cleanSpec,
                            dom_id: "#swagger-ui",
                            deepLinking: false,
                            presets: [
                                SwaggerUIBundle.presets.apis,
                                SwaggerUIStandalonePreset,
                            ],
                            plugins: [SwaggerUIBundle.plugins.DownloadUrl],
                            layout: "StandaloneLayout",
                            validatorUrl: null,
                            tryItOutEnabled: true,
                            supportedSubmitMethods: [
                                "get",
                                "post",
                                "put",
                                "delete",
                                "patch",
                            ],
                            requestInterceptor: function (request) {
                                console.log(
                                    "üé≠ Simulation Mode: Intercepting request for:",
                                    request.url,
                                );

                                // Generate mock response based on exercise and URL
                                const mockResponse = getMockResponse(
                                    exerciseNumber,
                                    request,
                                );

                                console.log(
                                    "‚úÖ Mock response generated:",
                                    mockResponse,
                                );

                                // Return the mock response immediately
                                return Promise.resolve(mockResponse);
                            },
                            onComplete: function () {
                                console.log(
                                    `‚úÖ Swagger UI loaded for Exercise ${exerciseNumber}`,
                                );
                                hideLoading();
                                isLoading = false;
                                processQueue();
                            },
                            onFailure: function (error) {
                                console.error(
                                    `‚ùå Swagger UI failed for Exercise ${exerciseNumber}:`,
                                    error,
                                );
                                showError();
                            },
                        });
                    } catch (error) {
                        console.error(
                            `‚ùå Error creating Swagger UI for Exercise ${exerciseNumber}:`,
                            error,
                        );
                        showError();
                    }
                }, 300);
            }

            function loadSwaggerDoc(exerciseNumber) {
                const exercise = exercises[exerciseNumber];
                if (!exercise) {
                    console.error(`Exercise ${exerciseNumber} not found`);
                    return;
                }

                // Clear any existing debounce timer
                if (debounceTimer) {
                    clearTimeout(debounceTimer);
                }

                // Debounce the loading to prevent rapid clicks
                debounceTimer = setTimeout(() => {
                    console.log(
                        `üìù Loading request for Exercise ${exerciseNumber}`,
                    );

                    // Clear existing queue to prevent conflicts
                    loadingQueue = [];

                    showLoading();
                    updateExerciseInfo(exerciseNumber);

                    // Update current exercise and active tab
                    currentExercise = exerciseNumber;
                    document
                        .querySelectorAll(".exercise-tab")
                        .forEach((tab) => {
                            tab.classList.remove("active");
                        });
                    document
                        .querySelector(`[data-exercise="${exerciseNumber}"]`)
                        .classList.add("active");

                    // Add to queue and process
                    loadingQueue.push(exerciseNumber);
                    processQueue();
                }, 100);
            }

            // Event listeners for exercise tabs
            document.querySelectorAll(".exercise-tab").forEach((tab) => {
                tab.addEventListener("click", function () {
                    const exerciseNumber = parseInt(this.dataset.exercise);
                    console.log(
                        `üñ±Ô∏è Tab clicked: Exercise ${exerciseNumber}, Current: ${currentExercise}, Loading: ${isLoading}`,
                    );
                    if (exerciseNumber !== currentExercise) {
                        loadSwaggerDoc(exerciseNumber);
                    }
                });
            });

            // Keyboard navigation
            document.addEventListener("keydown", function (e) {
                if (e.key === "ArrowLeft" && currentExercise > 1) {
                    console.log(
                        `‚¨ÖÔ∏è Arrow left: Moving from ${currentExercise} to ${currentExercise - 1}`,
                    );
                    loadSwaggerDoc(currentExercise - 1);
                } else if (e.key === "ArrowRight" && currentExercise < 8) {
                    console.log(
                        `‚û°Ô∏è Arrow right: Moving from ${currentExercise} to ${currentExercise + 1}`,
                    );
                    loadSwaggerDoc(currentExercise + 1);
                }
            });

            // Mock response generator for simulation
            function getMockResponse(exerciseNumber, request) {
                const url = request?.url || "/";
                const method = request?.method || "GET";

                // Parse URL to extract query parameters
                let urlObj;
                try {
                    urlObj = new URL(url, window.location.origin);
                } catch (e) {
                    urlObj = {
                        pathname: url,
                        searchParams: new URLSearchParams(),
                    };
                }

                const path = urlObj.pathname;
                const params = urlObj.searchParams;

                // Generate realistic mock responses based on exercise and endpoint
                let responseData = {};

                if (exerciseNumber === 1) {
                    if (path.includes("/health")) {
                        responseData = {
                            status: "healthy",
                            server: "Mock Server 1",
                            port: 3001,
                            uptime: Math.floor(Math.random() * 86400),
                            timestamp: new Date().toISOString(),
                            checks: {
                                database: "connected",
                                memory: "95% available",
                                cpu: "12% usage",
                            },
                        };
                    } else {
                        responseData = {
                            message:
                                "Welcome to Exercise 1 - Multi-Port Server Management!",
                            server: "Mock Server 1",
                            port: 3001,
                            timestamp: new Date().toISOString(),
                            activeConnections: Math.floor(Math.random() * 100),
                            version: "1.0.0",
                        };
                    }
                } else if (exerciseNumber >= 2 && exerciseNumber <= 7) {
                    // Calculator APIs - use actual query parameters if available
                    if (path.includes("/add")) {
                        const num1 = parseFloat(params.get("num1")) || 10;
                        const num2 = parseFloat(params.get("num2")) || 5;
                        const result = num1 + num2;
                        responseData = {
                            operation: "addition",
                            num1: num1,
                            num2: num2,
                            result: result,
                            timestamp: new Date().toISOString(),
                        };
                        if (exerciseNumber === 6)
                            responseData.testCoverage = "100%";
                        if (exerciseNumber === 7) {
                            responseData.logLevel = "INFO";
                            responseData.executionTime = `${Math.random() * 5}ms`;
                        }
                    } else if (path.includes("/subtract")) {
                        const num1 = parseFloat(params.get("num1")) || 20;
                        const num2 = parseFloat(params.get("num2")) || 8;
                        const result = num1 - num2;
                        responseData = {
                            operation: "subtraction",
                            num1: num1,
                            num2: num2,
                            result: result,
                            timestamp: new Date().toISOString(),
                        };
                        if (exerciseNumber === 6)
                            responseData.testCoverage = "100%";
                        if (exerciseNumber === 7) {
                            responseData.logLevel = "INFO";
                            responseData.executionTime = `${Math.random() * 5}ms`;
                        }
                    } else if (path.includes("/multiply")) {
                        const num1 = parseFloat(params.get("num1")) || 6;
                        const num2 = parseFloat(params.get("num2")) || 7;
                        const result = num1 * num2;
                        responseData = {
                            operation: "multiplication",
                            num1: num1,
                            num2: num2,
                            result: result,
                            timestamp: new Date().toISOString(),
                        };
                        if (exerciseNumber === 6)
                            responseData.testCoverage = "100%";
                        if (exerciseNumber === 7) {
                            responseData.logLevel = "INFO";
                            responseData.executionTime = `${Math.random() * 5}ms`;
                        }
                    } else if (path.includes("/divide")) {
                        const num1 = parseFloat(params.get("num1")) || 50;
                        const num2 = parseFloat(params.get("num2")) || 10;
                        const result =
                            num2 !== 0
                                ? num1 / num2
                                : "Error: Division by zero";
                        responseData = {
                            operation: "division",
                            num1: num1,
                            num2: num2,
                            result: result,
                            timestamp: new Date().toISOString(),
                        };
                        if (exerciseNumber === 6)
                            responseData.testCoverage = "100%";
                        if (exerciseNumber === 7) {
                            responseData.logLevel = "INFO";
                            responseData.executionTime = `${Math.random() * 5}ms`;
                        }
                    } else if (exerciseNumber === 3 && path === "/") {
                        // Portfolio page for Exercise 3
                        return {
                            url: url,
                            status: 200,
                            statusText: "OK",
                            headers: {
                                "Content-Type": "text/html",
                                "X-Mock-Response": "true",
                            },
                            text: "<!DOCTYPE html><html><head><title>My Portfolio</title></head><body><h1>Welcome to My Portfolio</h1><p>This is a sample portfolio page served by Exercise 3.</p></body></html>",
                        };
                    } else {
                        responseData = {
                            message: `Welcome to Exercise ${exerciseNumber} Calculator API!`,
                            availableOperations: [
                                "add",
                                "subtract",
                                "multiply",
                                "divide",
                            ],
                            timestamp: new Date().toISOString(),
                            version: "1.0.0",
                        };
                    }
                } else if (exerciseNumber === 4 || exerciseNumber === 5) {
                    // Friends APIs
                    if (path.includes("/friends") && method === "GET") {
                        if (path.includes("/filter")) {
                            const gender = params.get("gender") || "male";
                            const letter = params.get("letter") || "J";
                            const filteredFriends = [
                                { id: 1, name: "John Doe", gender: "male" },
                                { id: 3, name: "James Smith", gender: "male" },
                                {
                                    id: 7,
                                    name: "Jennifer Wilson",
                                    gender: "female",
                                },
                            ].filter(
                                (friend) =>
                                    friend.gender === gender &&
                                    friend.name.startsWith(letter),
                            );
                            responseData = {
                                message: "Friends filtered successfully",
                                count: filteredFriends.length,
                                filters: { gender, letter },
                                friends: filteredFriends,
                                timestamp: new Date().toISOString(),
                            };
                        } else if (path.match(/\/friends\/\d+$/)) {
                            const friendId = parseInt(path.split("/").pop());
                            responseData = {
                                message: `Friend found with ID ${friendId}`,
                                friend: {
                                    id: friendId,
                                    name: "John Doe",
                                    gender: "male",
                                    email: "john.doe@email.com",
                                },
                                timestamp: new Date().toISOString(),
                            };
                        } else {
                            responseData = {
                                message:
                                    exerciseNumber === 5
                                        ? "Retrieved all friends successfully (MVC)"
                                        : "Retrieved all friends successfully",
                                count: 5,
                                friends: [
                                    {
                                        id: 1,
                                        name: "John Doe",
                                        gender: "male",
                                        email: "john.doe@email.com",
                                    },
                                    {
                                        id: 2,
                                        name: "Jane Smith",
                                        gender: "female",
                                        email: "jane.smith@email.com",
                                    },
                                    {
                                        id: 3,
                                        name: "James Smith",
                                        gender: "male",
                                        email: "james.smith@email.com",
                                    },
                                    {
                                        id: 4,
                                        name: "Emily Johnson",
                                        gender: "female",
                                        email: "emily.johnson@email.com",
                                    },
                                    {
                                        id: 5,
                                        name: "Michael Brown",
                                        gender: "male",
                                        email: "michael.brown@email.com",
                                    },
                                ],
                                timestamp: new Date().toISOString(),
                            };
                            if (exerciseNumber === 5) {
                                responseData.metadata = {
                                    totalPages: 1,
                                    currentPage: 1,
                                    architecture: "MVC",
                                };
                            }
                        }
                    } else if (path.includes("/friends") && method === "POST") {
                        responseData = {
                            message:
                                exerciseNumber === 5
                                    ? "Friend added successfully (MVC)"
                                    : "Friend added successfully",
                            friend: {
                                id: 6,
                                name: "Alice Johnson",
                                gender: "female",
                                email: "alice.johnson@email.com",
                            },
                            totalFriends: 6,
                            timestamp: new Date().toISOString(),
                        };
                    } else if (path.includes("/friends") && method === "PUT") {
                        responseData = {
                            message: "Friend updated successfully",
                            friend: {
                                id: 1,
                                name: "John Updated",
                                gender: "male",
                                email: "john.updated@email.com",
                            },
                            timestamp: new Date().toISOString(),
                        };
                    } else if (
                        path.includes("/friends") &&
                        method === "DELETE"
                    ) {
                        responseData = {
                            message: "Friend deleted successfully",
                            deletedFriendId: 1,
                            remainingFriends: 4,
                            timestamp: new Date().toISOString(),
                        };
                    } else {
                        responseData = {
                            message: `Welcome to Exercise ${exerciseNumber} Friends API!`,
                            availableEndpoints: [
                                "/friends",
                                "/friends/filter",
                                "/friends/:id",
                            ],
                            timestamp: new Date().toISOString(),
                        };
                    }
                } else if (exerciseNumber === 8) {
                    // eCommerce API
                    if (path.includes("/products/categories")) {
                        responseData = {
                            success: true,
                            count: 4,
                            data: [
                                "electronics",
                                "jewelery",
                                "men's clothing",
                                "women's clothing",
                            ],
                            timestamp: new Date().toISOString(),
                            cached: true,
                            cacheExpiry: new Date(
                                Date.now() + 3600000,
                            ).toISOString(),
                        };
                    } else if (path.includes("/products/search")) {
                        const query = params.get("q") || "backpack";
                        responseData = {
                            success: true,
                            query: query,
                            count: 1,
                            data: [
                                {
                                    id: 1,
                                    title: "Fjallraven - Foldsack No. 1 Backpack",
                                    price: 109.95,
                                    category: "men's clothing",
                                    description:
                                        "Your perfect pack for everyday use and walks in the forest",
                                    image: "https://fakestoreapi.com/img/81fPKd-2AYL._AC_SL1500_.jpg",
                                    rating: { rate: 3.9, count: 120 },
                                },
                            ],
                            timestamp: new Date().toISOString(),
                            searchTime: `${Math.random() * 100}ms`,
                        };
                    } else if (path.includes("/products")) {
                        const limit = parseInt(params.get("limit")) || 20;
                        const products = [
                            {
                                id: 1,
                                title: "Fjallraven - Foldsack No. 1 Backpack",
                                price: 109.95,
                                category: "men's clothing",
                                description:
                                    "Your perfect pack for everyday use",
                                image: "https://fakestoreapi.com/img/81fPKd-2AYL._AC_SL1500_.jpg",
                                rating: { rate: 3.9, count: 120 },
                            },
                            {
                                id: 2,
                                title: "Mens Casual Premium Slim Fit T-Shirts",
                                price: 22.3,
                                category: "men's clothing",
                                description: "Slim-fitting style for men",
                                image: "https://fakestoreapi.com/img/71-3HjGNDUL._AC_SY879._SX._UX._SY._UY_.jpg",
                                rating: { rate: 4.1, count: 259 },
                            },
                            {
                                id: 3,
                                title: "Mens Cotton Jacket",
                                price: 55.99,
                                category: "men's clothing",
                                description: "Great outerwear for men",
                                image: "https://fakestoreapi.com/img/71li-ujtlUL._AC_UX679_.jpg",
                                rating: { rate: 4.7, count: 500 },
                            },
                        ];
                        responseData = {
                            success: true,
                            count: Math.min(products.length, limit),
                            limit: limit,
                            data: products.slice(0, limit),
                            timestamp: new Date().toISOString(),
                            cached: true,
                        };
                    } else {
                        responseData = {
                            message:
                                "Welcome to Exercise 8 - eCommerce Store API!",
                            availableEndpoints: [
                                "/api/products",
                                "/api/products/categories",
                                "/api/products/search",
                            ],
                            timestamp: new Date().toISOString(),
                            version: "2.0.0",
                        };
                    }
                } else {
                    responseData = {
                        message: `Mock response for Exercise ${exerciseNumber}`,
                        timestamp: new Date().toISOString(),
                        success: true,
                        data: {
                            exerciseNumber: exerciseNumber,
                            endpoint: path,
                            method: method,
                        },
                    };
                }

                return {
                    url: url,
                    status: 200,
                    statusText: "OK",
                    headers: {
                        "Content-Type": "application/json",
                        "X-Mock-Response": "true",
                        "X-Response-Time": `${Math.random() * 100}ms`,
                        "Access-Control-Allow-Origin": "*",
                    },
                    text: JSON.stringify(responseData, null, 2),
                };
            }

            // Initialize the app
            function initializeApp() {
                // Check for required libraries
                if (!window.SwaggerUIBundle) {
                    console.error("SwaggerUIBundle not loaded");
                    showError();
                    return;
                }

                if (!window.SwaggerUIStandalonePreset) {
                    console.error("SwaggerUIStandalonePreset not loaded");
                    showError();
                    return;
                }

                if (!window.swaggerSpecs) {
                    console.error("Swagger specifications not loaded");
                    showError();
                    return;
                }

                console.log("üöÄ Initializing Swagger Documentation App");
                console.log("‚úÖ SwaggerUIBundle loaded");
                console.log("‚úÖ SwaggerUIStandalonePreset loaded");
                console.log("‚úÖ Swagger specifications loaded");

                currentExercise = 1;
                updateExerciseInfo(1);
                showLoading();
                createSwaggerUI(1);
            }

            // Wait for DOM to be ready
            if (document.readyState === "loading") {
                document.addEventListener("DOMContentLoaded", initializeApp);
            } else {
                initializeApp();
            }

            // Add some helpful instructions
            console.log("Swagger Documentation Navigator - Simulation Mode");
            console.log("Use arrow keys to navigate between exercises");
            console.log("Left/Right arrows to switch between Exercise 1-8");
            console.log("All API responses are simulated with mock data");
        </script>
    </body>
</html>
